<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>書籍介紹平台</title>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --primary: #7c3aed;
      --primary-dark: #5b21b6;
      --secondary: #f3e8ff;
      --accent: #a78bfa;
      --text: #222;
      --radius: 14px;
    }
    * { box-sizing: border-box; }
    body {
      font-family: 'Noto Sans TC', sans-serif;
      margin: 0;
      background: var(--secondary);
      color: var(--text);
    }
    header {
      background: var(--primary);
      color: #fff;
      padding: 1.5rem 2rem;
      text-align: center;
      border-radius: 0 0 var(--radius) var(--radius);
      box-shadow: 0 2px 8px rgba(124,58,237,0.07);
    }
    nav {
      margin: 1.5rem 0;
      display: flex;
      justify-content: center;
      gap: 2rem;
    }
    nav a {
      color: var(--primary);
      text-decoration: none;
      font-weight: 700;
      padding: 0.5rem 1rem;
      border-radius: var(--radius);
      transition: background 0.2s;
    }
    nav a:hover {
      background: var(--primary);
      color: #fff;
    }
    .container {
      max-width: 1000px;
      margin: 2rem auto;
      background: #fff;
      border-radius: var(--radius);
      box-shadow: 0 2px 16px rgba(124,58,237,0.08);
      padding: 2rem;
    }
    .book-list {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      gap: 1.5rem;
    }
    .book-card {
      background: var(--secondary);
      border-radius: var(--radius);
      padding: 1.2rem;
      box-shadow: 0 1px 6px rgba(124,58,237,0.05);
      transition: transform 0.15s;
      display: flex;
      flex-direction: column;
      align-items: flex-start;
    }
    .book-card:hover {
      transform: translateY(-4px) scale(1.03);
      box-shadow: 0 4px 16px rgba(124,58,237,0.12);
    }
    .category {
      display: inline-block;
      background: var(--accent);
      color: #fff;
      border-radius: 8px;
      padding: 0.2rem 0.7rem;
      font-size: 0.95rem;
      margin-bottom: 0.5rem;
    }
    .login-modal {
      position: fixed;
      top: 0; left: 0; right: 0; bottom: 0;
      background: rgba(60,0,100,0.15);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 1000;
    }
    .login-box {
      background: #fff;
      border-radius: var(--radius);
      box-shadow: 0 2px 16px rgba(124,58,237,0.15);
      padding: 2rem 2.5rem;
      min-width: 320px;
      text-align: center;
    }
    .login-box input {
      width: 90%;
      margin: 0.7rem 0;
      padding: 0.6rem;
      border-radius: 8px;
      border: 1px solid #ccc;
      font-size: 1rem;
    }
    .login-box button {
      background: var(--primary);
      color: #fff;
      border: none;
      border-radius: 8px;
      padding: 0.7rem 2.2rem;
      font-size: 1.1rem;
      font-weight: 700;
      cursor: pointer;
      margin-top: 1rem;
      transition: background 0.2s;
    }
    .login-box button:hover {
      background: var(--primary-dark);
    }
    .logout-btn {
      float: right;
      margin-top: -2.5rem;
      margin-right: 1rem;
      background: var(--primary-dark);
      color: #fff;
      border: none;
      border-radius: 8px;
      padding: 0.4rem 1.2rem;
      font-size: 0.95rem;
      cursor: pointer;
    }
    .edit-btn {
      background: var(--accent);
      color: #fff;
      border: none;
      border-radius: 8px;
      padding: 0.4rem 1.2rem;
      font-size: 0.95rem;
      cursor: pointer;
      margin-left: 0.5rem;
    }
    .comment-section {
      margin-top: 1.5rem;
      background: #f8f0ff;
      border-radius: 10px;
      padding: 1rem 1.5rem;
    }
    .comment-list {
      margin: 0.5rem 0 0 0;
      padding: 0;
      list-style: none;
    }
    .comment-list li {
      border-bottom: 1px solid #e0d7f7;
      padding: 0.5rem 0;
      font-size: 1rem;
    }
    .comment-list li:last-child { border-bottom: none; }
    .comment-form {
      display: flex;
      gap: 0.5rem;
      margin-top: 1rem;
    }
    .comment-form input {
      flex: 1;
      padding: 0.5rem;
      border-radius: 6px;
      border: 1px solid #ccc;
    }
    .comment-form button {
      background: var(--primary);
      color: #fff;
      border: none;
      border-radius: 6px;
      padding: 0.5rem 1.2rem;
      font-weight: 700;
      cursor: pointer;
    }
    @media (max-width: 700px) {
      .container { padding: 1rem; }
      .book-list { grid-template-columns: 1fr; }
    }
  </style>
</head>
<body>
  <header>
    <h1>書籍介紹平台</h1>
    <p>發現、分享與討論你喜愛的書籍</p>
    <button class="logout-btn" style="display:none" onclick="logout()">登出</button>
  </header>
  <nav>
    <a href="#" onclick="showCategory('全部')">全部</a>
    <a href="#" onclick="showCategory('小說')">小說</a>
    <a href="#" onclick="showCategory('技術')">技術</a>
    <a href="#" onclick="showCategory('心理')">心理</a>
    <a href="#" onclick="showCategory('其他')">其他</a>
    <button class="edit-btn" style="display:none" onclick="editLayout()">編輯版面</button>
  </nav>
  <div class="container">
    <div id="book-list" class="book-list"></div>
  </div>
  <!-- 登入/註冊視窗 -->
  <div class="login-modal" id="login-modal">
    <div class="login-box">
      <h2 id="login-title">版主登入</h2>
      <input type="text" id="login-user" placeholder="帳號">
      <input type="password" id="login-pw" placeholder="密碼">
      <button id="login-btn" onclick="login()">登入</button>
      <button id="switch-btn" style="margin-left:1rem;" onclick="switchMode()">註冊</button>
      <div id="login-msg" style="color:#b91c1c;margin-top:0.5rem;"></div>
    </div>
  </div>
  <script>
    // 書籍資料（可自行擴充）
    let books = [
      { id:1, title:'解憂雜貨店', author:'東野圭吾', category:'小說', desc:'一間神祕的雜貨店，解答人們的煩惱。', comments:[] },
      { id:2, title:'JavaScript 實戰', author:'王小明', category:'技術', desc:'從入門到進階，帶你掌握 JS 核心。', comments:[] },
      { id:3, title:'被討厭的勇氣', author:'岸見一郎', category:'心理', desc:'阿德勒心理學經典，改變人生的勇氣。', comments:[] },
      { id:4, title:'自訂書籍', author:'自訂作者', category:'其他', desc:'你可以在編輯模式新增/修改書籍。', comments:[] }
    ];
    // 儲存留言到 localStorage
    function saveComments() {
      localStorage.setItem('bookComments', JSON.stringify(books.map(b=>b.comments)));
    }
    // 載入留言
    function loadComments() {
      let c = localStorage.getItem('bookComments');
      if(c) {
        let arr = JSON.parse(c);
        books.forEach((b,i)=>{ b.comments = arr[i]||[]; });
      }
    }
    // 顯示書籍列表
    function renderBooks(category='全部') {
      loadComments();
      let list = document.getElementById('book-list');
      let show = category==='全部' ? books : books.filter(b=>b.category===category);
      list.innerHTML = show.map(b=>`
        <div class="book-card">
          <span class="category">${b.category}</span>
          <h3>${b.title}</h3>
          <div style="color:#7c3aed;font-size:1.05rem;">作者：${b.author}</div>
          <p>${b.desc}</p>
          <div class="comment-section">
            <strong>留言區</strong>
            <ul class="comment-list" id="comments-${b.id}">
              ${(b.comments||[]).map(c=>`<li>${c}</li>`).join('')}
            </ul>
            <form class="comment-form" onsubmit="addComment(event,${b.id})">
              <input type="text" placeholder="寫下你的想法..." required>
              <button type="submit">留言</button>
            </form>
          </div>
        </div>
      `).join('');
    }
    // 切換分類
    function showCategory(cat) {
      renderBooks(cat);
    }
    // 新增留言
    function addComment(e, id) {
      e.preventDefault();
      let input = e.target.querySelector('input');
      let val = input.value.trim();
      if(val) {
        let book = books.find(b=>b.id===id);
        book.comments = book.comments || [];
        book.comments.push(val);
        saveComments();
        renderBooks();
      }
      input.value = '';
    }
    // 註冊/登入模式切換
    let isRegister = false;
    function switchMode() {
      isRegister = !isRegister;
      document.getElementById('login-title').innerText = isRegister ? '註冊新帳號' : '版主登入';
      document.getElementById('login-btn').innerText = isRegister ? '註冊' : '登入';
      document.getElementById('switch-btn').innerText = isRegister ? '返回登入' : '註冊';
      document.getElementById('login-msg').innerText = '';
    }
    // 註冊功能
    function register() {
      let user = document.getElementById('login-user').value;
      let pw = document.getElementById('login-pw').value;
      if(!user || !pw) {
        document.getElementById('login-msg').innerText = '請輸入帳號與密碼';
        return;
      }
      if(localStorage.getItem('user_'+user)) {
        document.getElementById('login-msg').innerText = '帳號已存在';
        return;
      }
      localStorage.setItem('user_'+user, pw);
      document.getElementById('login-msg').innerText = '註冊成功，請登入';
      switchMode();
    }
    // 修改登入按鈕行為
    function login() {
      let user = document.getElementById('login-user').value;
      let pw = document.getElementById('login-pw').value;
      if(isRegister) {
        register();
        return;
      }
      // 內建版主帳號
      if(user==='0315' && pw==='0315') {
        document.getElementById('login-modal').style.display='none';
        document.querySelector('.logout-btn').style.display='inline-block';
        document.querySelector('.edit-btn').style.display='inline-block';
        localStorage.setItem('isAdmin','1');
        localStorage.setItem('currentUser', user);
      } else if(localStorage.getItem('user_'+user) === pw) {
        document.getElementById('login-modal').style.display='none';
        document.querySelector('.logout-btn').style.display='inline-block';
        document.querySelector('.edit-btn').style.display='none'; // 一般用戶無編輯權限
        localStorage.setItem('isAdmin','0');
        localStorage.setItem('currentUser', user);
      } else {
        document.getElementById('login-msg').innerText = '帳號或密碼錯誤';
      }
    }
    // 登出
    function logout() {
      localStorage.removeItem('isAdmin');
      localStorage.removeItem('currentUser');
      document.querySelector('.logout-btn').style.display='none';
      document.querySelector('.edit-btn').style.display='none';
      document.getElementById('login-modal').style.display='flex';
    }
    // 版主編輯模式（可擴充：新增/刪除/編輯書籍、調整版面）
    function editLayout() {
      alert('這裡可擴充為版主專屬的版面編輯功能！');
    }
    // 自動登入狀態
    window.onload = function() {
      loadComments();
      renderBooks();
      if(localStorage.getItem('currentUser')) {
        document.getElementById('login-modal').style.display='none';
        document.querySelector('.logout-btn').style.display='inline-block';
        if(localStorage.getItem('isAdmin')==='1') {
          document.querySelector('.edit-btn').style.display='inline-block';
        } else {
          document.querySelector('.edit-btn').style.display='none';
        }
      }
    }
  </script>
</body>
</html>
